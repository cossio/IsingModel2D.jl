<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>The 2-dimensional Ising model · SquareIsingModel.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SquareIsingModel.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">SquareIsingModel.jl Documentation</a></li><li class="is-active"><a class="tocitem" href>The 2-dimensional Ising model</a><ul class="internal"><li><a class="tocitem" href="#example_metropolis"><span>Example simulation with Metropolis</span></a></li><li><a class="tocitem" href="#example_wolff"><span>Example simulation with Wolff</span></a></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>The 2-dimensional Ising model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>The 2-dimensional Ising model</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cossio/SquareIsingModel.jl/blob/master/docs/src/ising.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-2-dimensional-Ising-model"><a class="docs-heading-anchor" href="#The-2-dimensional-Ising-model">The 2-dimensional Ising model</a><a id="The-2-dimensional-Ising-model-1"></a><a class="docs-heading-anchor-permalink" href="#The-2-dimensional-Ising-model" title="Permalink"></a></h1><p>The 2-dimensional Ising model is defined by the energy function:</p><p class="math-container">\[E(\mathbf{\sigma}) = - \sum_{\langle i j \rangle} \sigma_i \sigma_j\]</p><p>where <span>$\langle i j \rangle$</span> refers to connected pairs of sites in the square grid lattice, and <span>$\sigma_i = \pm 1$</span> are spins. At inverse temperature <span>$\beta$</span>, this defines a Boltzmann probability distribution:</p><p class="math-container">\[P(\mathbf{\sigma}) = \frac{1}{Z} \mathrm{e}^{-\beta E (\mathbf{\sigma})}\]</p><p>where</p><p class="math-container">\[Z = \sum_{\mathbf{\sigma}} \mathrm{e}^{-\beta E(\mathbf{\sigma})}\]</p><p>is the partition function.</p><p>In the two-dimensional grid lattice, we assume we have a <span>$L\times K$</span> plane grid, where each spin is connected to its four neighbors. We assume periodic boundary conditions, so spin <code>(1,1)</code> is connected to spin <code>(L,K)</code>.</p><p>In the thermodynamic limit (large <code>L</code> with <code>K = L</code>), this model suffers a phase transition at the critical inverse temperature <span>$\beta \approx 0.44$</span> (called <a href="@ref"><code>βc</code></a> in the package).</p><h2 id="example_metropolis"><a class="docs-heading-anchor" href="#example_metropolis">Example simulation with Metropolis</a><a id="example_metropolis-1"></a><a class="docs-heading-anchor-permalink" href="#example_metropolis" title="Permalink"></a></h2><pre><code class="language-julia hljs">using SquareIsingModel: metropolis!, onsager_magnetization, βc
using Statistics, CairoMakie, Random, ProgressMeter

Random.seed!(1) # make reproducible

βs = 0:0.05:1 # inverse temperatures to simulate
mavg = zeros(length(βs))
mstd = zeros(length(βs))
spins = rand((Int8(1), Int8(-1)), 50, 50);
@showprogress for (k,β) in enumerate(βs)
    spins_t, m, E = metropolis!(spins, β, 10^7)
    mavg[k] = mean(m[(length(m) ÷ 2):end])
    mstd[k] = std(m[(length(m) ÷ 2):end])
end
mavg .= abs.(mavg) # remove sign invariance

fig = Figure(resolution=(600,400))
ax = Axis(fig[1,1], xlabel=&quot;β&quot;, ylabel=&quot;m&quot;)
lines!(ax, 0:0.01:1, onsager_magnetization, color=:black, label=&quot;analytical&quot;)
scatter!(ax, βs, mavg, color=:red, markersize=5, label=&quot;MC&quot;)
errorbars!(ax, βs, mavg, mstd/2, color=:red, whiskerwidth=5)
axislegend(ax, position=:rb)
fig</code></pre><img src="data:image/png;base64,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" /><h2 id="example_wolff"><a class="docs-heading-anchor" href="#example_wolff">Example simulation with Wolff</a><a id="example_wolff-1"></a><a class="docs-heading-anchor-permalink" href="#example_wolff" title="Permalink"></a></h2><pre><code class="language- hljs">using SquareIsingModel: metropolis!, onsager_magnetization, βc
using Statistics, CairoMakie, Random, ProgressMeter

Random.seed!(1) # make reproducible

βs = 0:0.05:1 # inverse temperatures to simulate
mavg = zeros(length(βs))
mstd = zeros(length(βs))
spins = rand((Int8(1), Int8(-1)), 50, 50);
@showprogress for (k,β) in enumerate(βs)
    spins_t, m, E = wolff!(spins, β, 10^7)
    mavg[k] = mean(m[(length(m) ÷ 2):end])
    mstd[k] = std(m[(length(m) ÷ 2):end])
end
mavg .= abs.(mavg) # remove sign invariance

fig = Figure(resolution=(600,400))
ax = Axis(fig[1,1], xlabel=&quot;β&quot;, ylabel=&quot;m&quot;)
lines!(ax, 0:0.01:1, onsager_magnetization, color=:black, label=&quot;analytical&quot;)
scatter!(ax, βs, mavg, color=:red, markersize=5, label=&quot;MC&quot;)
errorbars!(ax, βs, mavg, mstd/2, color=:red, whiskerwidth=5)
axislegend(ax, position=:rb)
fig</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« SquareIsingModel.jl Documentation</a><a class="docs-footer-nextpage" href="../reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Saturday 13 November 2021 10:31">Saturday 13 November 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
