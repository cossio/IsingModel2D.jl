<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Wolff sampler · IsingModels.jl</title><meta name="title" content="Wolff sampler · IsingModels.jl"/><meta property="og:title" content="Wolff sampler · IsingModels.jl"/><meta property="twitter:title" content="Wolff sampler · IsingModels.jl"/><meta name="description" content="Documentation for IsingModels.jl."/><meta property="og:description" content="Documentation for IsingModels.jl."/><meta property="twitter:description" content="Documentation for IsingModels.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">IsingModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../ising/">The Ising Model</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../metropolis/">Metropolis</a></li><li class="is-active"><a class="tocitem" href>Wolff sampler</a><ul class="internal"><li><a class="tocitem" href="#Magnetization-as-a-function-of-temperature"><span>Magnetization as a function of temperature</span></a></li><li><a class="tocitem" href="#Typical-Wolff-clusters-at-criticality"><span>Typical Wolff clusters at criticality</span></a></li><li><a class="tocitem" href="#Average-size-of-Wolff&#39;s-clusters-as-a-function-of-temperature"><span>Average size of Wolff&#39;s clusters as a function of temperature</span></a></li><li><a class="tocitem" href="#Wolff-explores-configurations-efficiently-at-the-critical-temperature"><span>Wolff explores configurations efficiently at the critical temperature</span></a></li><li><a class="tocitem" href="#Binder&#39;s-parameter"><span>Binder&#39;s parameter</span></a></li><li><a class="tocitem" href="#Heat-capacity-vs.-exact-expression"><span>Heat capacity vs. exact expression</span></a></li><li><a class="tocitem" href="#Internal-energy-vs.-exact-expression"><span>Internal energy vs. exact expression</span></a></li></ul></li><li><a class="tocitem" href="../hybrid/">Hybrid sampler</a></li><li><a class="tocitem" href="../metropolis_f/">Metropolis+f(M)</a></li></ul></li><li><a class="tocitem" href="../../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Wolff sampler</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Wolff sampler</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cossio/IsingModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/cossio/IsingModels.jl/blob/main/docs/src/literate/wolff.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples-using-Wolff-cluster-sampling-method"><a class="docs-heading-anchor" href="#Examples-using-Wolff-cluster-sampling-method">Examples using Wolff cluster sampling method</a><a id="Examples-using-Wolff-cluster-sampling-method-1"></a><a class="docs-heading-anchor-permalink" href="#Examples-using-Wolff-cluster-sampling-method" title="Permalink"></a></h1><h2 id="Magnetization-as-a-function-of-temperature"><a class="docs-heading-anchor" href="#Magnetization-as-a-function-of-temperature">Magnetization as a function of temperature</a><a id="Magnetization-as-a-function-of-temperature-1"></a><a class="docs-heading-anchor-permalink" href="#Magnetization-as-a-function-of-temperature" title="Permalink"></a></h2><p>First load some packages</p><pre><code class="language-julia hljs">import IsingModels as Ising
using Statistics, CairoMakie, Random

Random.seed!(1) # make reproducible</code></pre><p>First example.</p><pre><code class="language-julia hljs">βs = 0:0.025:1
fig = Figure(resolution=(600,400))
ax = Axis(fig[1,1], xlabel=&quot;β&quot;, ylabel=&quot;m&quot;)
lines!(ax, 0:0.01:1, Ising.onsager_magnetization, color=:black, label=&quot;analytical&quot;)

mavg = zeros(length(βs))
mstd = zeros(length(βs))
σ = bitrand(32, 32)
for (k,β) in enumerate(βs)
    σ_t, M, E = Ising.wolff!(σ, β, steps=10^3)
    m = abs.(M[(length(M) ÷ 2):end]) / length(σ)
    mavg[k] = mean(m)
    mstd[k] = std(m)
end
scatter!(ax, βs, mavg, color=:blue, markersize=5, label=&quot;MC, L=30&quot;)
errorbars!(ax, βs, mavg, mstd/2, color=:blue, whiskerwidth=5)

mavg = zeros(length(βs))
mstd = zeros(length(βs))
σ = bitrand(64, 64)
for (k,β) in enumerate(βs)
    σ_t, M, E = Ising.wolff!(σ, β, steps=10^3)
    m = abs.(M[(length(M) ÷ 2):end]) / length(σ)
    mavg[k] = mean(m)
    mstd[k] = std(m)
end
scatter!(ax, βs, mavg, color=:red, markersize=5, label=&quot;MC, L=70&quot;)
errorbars!(ax, βs, mavg, mstd/2, color=:red, whiskerwidth=5)

axislegend(ax, position=:rb)
fig</code></pre><img src="11637677.png" alt="Example block output"/><h2 id="Typical-Wolff-clusters-at-criticality"><a class="docs-heading-anchor" href="#Typical-Wolff-clusters-at-criticality">Typical Wolff clusters at criticality</a><a id="Typical-Wolff-clusters-at-criticality-1"></a><a class="docs-heading-anchor-permalink" href="#Typical-Wolff-clusters-at-criticality" title="Permalink"></a></h2><pre><code class="language-julia hljs">import IsingModels as Ising
using Random, Colors, ColorSchemes, CairoMakie
Random.seed!(56) # reproducibility
β = Ising.βc
σ = bitrand(512, 512)
Ising.metropolis!(σ, β; steps=10^7)
Ising.wolff!(σ, β, steps=500)
cluster = Ising.wolff_cluster(σ, CartesianIndex(256, 256), Ising.wolff_padd(β))

fig = Figure(resolution=(700, 350))
ax = Axis(fig[1,1], title=&quot;spins&quot;)
hmap = heatmap!(ax, σ, colormap=cgrad([:purple, :orange], [0.5]; categorical=true))
hidedecorations!(ax)
ax = Axis(fig[1,2], title=&quot;cluster&quot;)
hmap = heatmap!(ax, cluster, colormap=cgrad([:white, :black], [0.5]; categorical=true))
hidedecorations!(ax)
fig</code></pre><img src="42e5b057.png" alt="Example block output"/><h2 id="Average-size-of-Wolff&#39;s-clusters-as-a-function-of-temperature"><a class="docs-heading-anchor" href="#Average-size-of-Wolff&#39;s-clusters-as-a-function-of-temperature">Average size of Wolff&#39;s clusters as a function of temperature</a><a id="Average-size-of-Wolff&#39;s-clusters-as-a-function-of-temperature-1"></a><a class="docs-heading-anchor-permalink" href="#Average-size-of-Wolff&#39;s-clusters-as-a-function-of-temperature" title="Permalink"></a></h2><pre><code class="language-julia hljs">import IsingModels as Ising
using Random, Statistics, Colors, ColorSchemes, CairoMakie

Random.seed!(1) # make reproducible

Ts = 0:0.2:5
βs = inv.(Ts)
fig = Figure(resolution=(600,400))
ax = Axis(fig[1,1], xlabel=L&quot;temperature $T$&quot;, ylabel=L&quot;average Wolff&#39;s cluster size / $N$&quot;)

clavg = zeros(length(βs))
clstd = zeros(length(βs))
σ = bitrand(32, 32)
for (k,β) in enumerate(βs)
    σ_t, M, E = Ising.wolff!(σ, β, steps=10^3)
    cluster_size = abs.(M[2:end] - M[1:(end - 1)]) .÷ 2
    clavg[k] = mean(cluster_size / length(σ))
    clstd[k] = std(cluster_size / length(σ))
end
scatter!(ax, Ts, clavg, color=:blue, markersize=5, label=&quot;L=30&quot;)
lines!(ax, Ts, clavg, color=:blue)
errorbars!(ax, Ts, clavg, clstd/2, color=:blue, whiskerwidth=5)

clavg = zeros(length(βs))
clstd = zeros(length(βs))
σ = bitrand(64, 64)
for (k,β) in enumerate(βs)
    σ_t, M, E = Ising.wolff!(σ, β, steps=10^3)
    cluster_size = abs.(M[2:end] - M[1:(end - 1)]) .÷ 2
    clavg[k] = mean(cluster_size / length(σ))
    clstd[k] = std(cluster_size / length(σ))
end
scatter!(ax, Ts, clavg, color=:red, markersize=5, label=&quot;L=70&quot;)
lines!(ax, Ts, clavg, color=:red)
errorbars!(ax, Ts, clavg, clstd/2, color=:red, whiskerwidth=5)
vlines!(ax, [1 / Ising.βc], label=L&quot;Onsager&#39;s $T_c$&quot;, color=:black, linestyle=:dash)

axislegend(ax, position=:rt)
fig</code></pre><img src="6613fa1d.png" alt="Example block output"/><h2 id="Wolff-explores-configurations-efficiently-at-the-critical-temperature"><a class="docs-heading-anchor" href="#Wolff-explores-configurations-efficiently-at-the-critical-temperature">Wolff explores configurations efficiently at the critical temperature</a><a id="Wolff-explores-configurations-efficiently-at-the-critical-temperature-1"></a><a class="docs-heading-anchor-permalink" href="#Wolff-explores-configurations-efficiently-at-the-critical-temperature" title="Permalink"></a></h2><p>The following example shows how at the critical temperature, the Metropolis sampler gets stuck in particular cluster structures. In contrast the Wolff algorihm explores diverse states.</p><pre><code class="language-julia hljs">using Statistics, CairoMakie, Random
import IsingModels as Ising

Random.seed!(3) # reproducibility

L = 128
N = L^2
σ_t_metro, M_metro, E_metro = Ising.metropolis!(falses(L, L), Ising.βc; steps=10^6, save_interval=2*10^5)
σ_t_wolff, M_wolff, E_wolff = Ising.wolff!(falses(L, L), Ising.βc, steps=10^4, save_interval=2*10^3)

fig = Figure(resolution=(1000, 800))
for t in 1:size(σ_t_metro, 3)
    ax = Axis(fig[1,1][1,t], title=&quot;t=$t, metropolis&quot;)
    heatmap!(ax, σ_t_metro[:,:,t], colorrange=(0,1), colormap=cgrad([:purple, :orange], [0.5]; categorical=true))
    hidedecorations!(ax)
end
for t in 1:size(σ_t_wolff, 3)
    ax = Axis(fig[1,1][2,t], title=&quot;t=$t, wolff&quot;)
    heatmap!(ax, σ_t_wolff[:,:,t], colorrange=(0,1), colormap=cgrad([:purple, :orange], [0.5]; categorical=true))
    hidedecorations!(ax)
end

ax = Axis(fig[2,1][1,1], title=&quot;magnetization&quot;)
lines!(ax, M_wolff[1:10:end] / N, label=&quot;wolff&quot;)
lines!(ax, M_metro[1:1000:end] / N, label=&quot;metropolis&quot;, linewidth=2, color=:red)
ylims!(ax, (-1,1))

ax = Axis(fig[2,1][1,2], title=&quot;energy&quot;)
lines!(ax, E_wolff[1:10:end] / N, label=&quot;wolff&quot;)
lines!(ax, E_metro[1:1000:end] / N, label=&quot;metropolis&quot;, linewidth=2, color=:red)
axislegend(ax, position = :rb)

fig</code></pre><img src="0b2c934c.png" alt="Example block output"/><h2 id="Binder&#39;s-parameter"><a class="docs-heading-anchor" href="#Binder&#39;s-parameter">Binder&#39;s parameter</a><a id="Binder&#39;s-parameter-1"></a><a class="docs-heading-anchor-permalink" href="#Binder&#39;s-parameter" title="Permalink"></a></h2><p>As the system size grows, the crossing point of the different curves is the critical temperature.</p><pre><code class="language-julia hljs">using Statistics, CairoMakie, Random
import IsingModels as Ising

Random.seed!(1) # make reproducible
Ts = 2.2:0.01:2.3
βs = inv.(Ts)

fig = Figure(resolution=(600, 400))
ax = Axis(fig[1,1], xlabel=L&quot;temperature $T$ ($=1/\beta$)&quot;, ylabel=&quot;Binder parameter&quot;)
@time for (L, color) in zip([4, 8, 16, 32], [:green, :orange, :blue, :red])
    U = zeros(length(βs))
    σ = bitrand(L, L)
    for (k, β) in enumerate(βs)
        σ_t, M, E = Ising.wolff!(σ, β, steps=10^5)
        U[k] = (3 - mean(M.^4) / mean(M.^2)^2) / 2
    end
    scatter!(ax, Ts, U, color=color, markersize=5, label=L&quot;L=%$L&quot;)
    lines!(ax, Ts, U, color=color, markersize=5)
end
vlines!(ax, [1 / Ising.βc], label=L&quot;Onsager&#39;s $T_c$&quot;, color=:black, linestyle=:dash)
axislegend(ax, position=:lb)

fig</code></pre><img src="03320192.png" alt="Example block output"/><h2 id="Heat-capacity-vs.-exact-expression"><a class="docs-heading-anchor" href="#Heat-capacity-vs.-exact-expression">Heat capacity vs. exact expression</a><a id="Heat-capacity-vs.-exact-expression-1"></a><a class="docs-heading-anchor-permalink" href="#Heat-capacity-vs.-exact-expression" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Statistics, CairoMakie, Random
import IsingModels as Ising

Random.seed!(1) # make reproducible
Ts = 1.8:0.01:3
βs = inv.(Ts)

fig = Figure(resolution=(800, 400))
ax = Axis(fig[1,1], xlabel=L&quot;temperature $T$ ($=1/\beta$)&quot;, ylabel=&quot;heat capacity&quot;, limits=(extrema(Ts)..., 0,2))

@time for (L, color) in zip([4, 8, 16, 32], [:green, :orange, :blue, :red])
    C = zeros(length(βs))
    for (k, β) in enumerate(βs)
        σ = bitrand(L, L)
        σ_t, M, E = Ising.wolff!(σ, β, steps=10^5)
        C[k] = β^2/length(σ) * var(E)
    end
    scatter!(ax, Ts, C, color=color, markersize=5, label=L&quot;L=%$L&quot;)
end
lines!(ax, Ts, Ising.onsager_heat_capacity.(βs), color=:black, label=&quot;exact&quot;)
vlines!(ax, [1 / Ising.βc], label=L&quot;Onsager&#39;s $T_c$&quot;, color=:black, linestyle=:dash)
Legend(fig[1,2], ax)

fig</code></pre><img src="826b4493.png" alt="Example block output"/><h2 id="Internal-energy-vs.-exact-expression"><a class="docs-heading-anchor" href="#Internal-energy-vs.-exact-expression">Internal energy vs. exact expression</a><a id="Internal-energy-vs.-exact-expression-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-energy-vs.-exact-expression" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Statistics, CairoMakie, Random
import IsingModels as Ising

Random.seed!(1) # make reproducible
Ts = 1.8:0.05:3
βs = inv.(Ts)

fig = Figure(resolution=(800, 400))
ax = Axis(fig[1,1], xlabel=L&quot;temperature $T$ ($=1/\beta$)&quot;, ylabel=&quot;internal energy&quot;)

@time for (L, color) in zip([4, 8, 16, 32], [:green, :orange, :blue, :red])
    Eavg = zeros(length(βs))
    Estd = zeros(length(βs))
    for (k, β) in enumerate(βs)
        σ = bitrand(L, L)
        σ_t, M, E = Ising.wolff!(σ, β, steps=10^5)
        Eavg[k] = mean(E / length(σ))
        Estd[k] = std(E / length(σ))
    end
    scatter!(ax, Ts, Eavg, color=color, markersize=5, label=L&quot;L=%$L&quot;)
    errorbars!(ax, Ts, Eavg, Estd/2, color=color, whiskerwidth=5)
end
lines!(ax, Ts, Ising.onsager_internal_energy.(βs), color=:black, label=&quot;exact&quot;)
vlines!(ax, [1 / Ising.βc], label=L&quot;Onsager&#39;s $T_c$&quot;, color=:black, linestyle=:dash)
Legend(fig[1,2], ax)

fig</code></pre><img src="09a993ce.png" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../metropolis/">« Metropolis</a><a class="docs-footer-nextpage" href="../hybrid/">Hybrid sampler »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.0.1 on <span class="colophon-date" title="Saturday 23 September 2023 18:29">Saturday 23 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
